---------------------------------------------------------------------------------------------- GitLab to OmniFocus-- -- by Ryan Dotson, with additions from Rosemary Orchard---- Version 2-- 17 December 2019---- <https://github.com/nostodnayr/gitlab-issue-to-omnifocus>---- This script takes a GitLab issue or merge request open in front Safari window and-- creates an action in OmniFocus with a note including a link and the text of the item.---- This AppleScript relies on two Perl scripts to get the work done. They are:----    + gitlab-to-omnifocus-sorter.pl: Determines which project the action is sorted into--    + gitlab-to-omnifocus-titler.pl: Prettifies the action title---- IMPORTANT-- The sorter script must be edited by you to suit your needs. Instructions for doing-- so can be found in that script.---- To use, copy all three scripts to ~/Library/Scripts/Applications/Safari/-- I trigger the script with a keyboard shortcut assigned through FastScripts-- (to the AppleScript, not the Perl scripts).---- The script will try to handle itself gracefully, and if the item doesn't match-- a project you've specified or isn't a GitLab page, it will open the Quick Entry-- window with the page information filled.---- Known Limitations: - The script may behave unexpectedly if you have multiple projects--                      with the same name--------------------------------------------------------------------------------------------tell document 1 of application "Safari"	set _page_title to the name as string	set _page_url to the URL	set _issue_content to do JavaScript "x = document.getElementsByClassName('description js-task-list-container is-task-list-enabled')[0].innerText;"	set _issue_author to do JavaScript "x = document.getElementsByClassName('author-link')[0].innerText;"end tellset _action_title to ¬	do shell script "perl ~/Library/Scripts/Applications/Safari/gitlab-to-omnifocus-titler.pl '" & _page_title & "'"set _project_sort to ¬	do shell script "perl ~/Library/Scripts/Applications/Safari/gitlab-to-omnifocus-sorter.pl '" & _page_title & "'"tell application "OmniFocus"	try		tell default document			if (_action_title is "**NOT GITLAB**") or (_project_sort is "") then				tell quick entry					activate					make new inbox task with properties {name:_page_title, note:_page_url}					open				end tell			else				set _action_note to ¬					_page_url & return & "Created by: " & _issue_author & return & return & _issue_content								tell (first flattened project where its name is _project_sort)					set _action to make new task with properties {name:_action_title, note:_action_note}				end tell								-- display the alert in Safari so we don't have to switch to OmniFocus				tell application "Safari"					set _alert_message to "Action Created in " & _project_sort					set _alert_result to display alert _alert_message message _action_title ¬						buttons {"Show in OmniFocus", "OK"} default button "OK" giving up after 5				end tell								if button returned of _alert_result is "Show in OmniFocus" then					GetURL "omnifocus:///task/" & the id of _action					-- if you would prefer the action be displayed in a new window, comment					-- out the 'GetURL' line above and uncomment the following 'tell' line:					-- tell (make new document window) to GetURL "omnifocus:///task/" & the id of _action					activate				end if			end if		end tell	on error errMsg number eNum		tell application "OmniFocus"			activate			display alert eNum message errMsg		end tell	end tryend tell